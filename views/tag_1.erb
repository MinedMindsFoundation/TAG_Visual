<!doctype html>
<meta charset="utf-8">
<html>
<style>
    .bar {
        fill: steelblue;
    }

    .bar:hover {
        fill: brown;
    }

    .toolTip {
        position: absolute;
        display: none;
        min-width: 80px;
        height: auto;
        background: none repeat scroll 0 0 #ffffff;
        border: 1px solid #6F257F;
        padding: 14px;
        text-align: center;
        }
</style>



<head>
    
    <h1> </h1>
</head>

<body>
    <div></div>
    <script src="http://d3js.org/d3.v4.min.js"></script>
    <script>
    
        //set the dimensions and margins of the graph
        var margin = {
                top: 20,
                right: 20,
                bottom: 30,
                left: 320,
            },
            width = 1200- margin.left - margin.right,
            height = 600 - margin.top - margin.bottom;

        // set the ranges
        var y = d3.scaleBand()
            .range([height, 0])
            .padding(0.1);

        var x = d3.scaleLinear()
            .range([0, width]);

        // append the svg object to the body of the page
        // append a 'group' element to 'svg'
        // moves the 'group' element to the top left margin
        var svg = d3.select("body").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform",
                "translate(" + margin.left + "," + margin.top + ")");
        
        var tooltip = d3.select("body").append("div").attr("class", "toolTip");

        d3.csv("csv/r_X_csv.csv", function(error, data) {
            // console.log("data", data)
        var myData = [];
        var myArr = [];
        var bidArr = [];
            data.forEach(function(d) {
                var myBids = {}
                if (d.generic_name != "") {
                    myBids["medicine"] = (d.generic_name);
                    if (myBids !== {}) {
                        myArr.push(myBids);
                        //console.log("myBids", myBids)
                    };
                };
                if (d.priority == "CURRENT #1") {
                    myBids["bid"] = (d.bid_price);
                    //console.log(parseInt(d.bid_price))
                    bidArr.push(parseFloat(d.bid_price))
                    if (myBids !== {}) {
                        myArr.push(myBids);
                        // console.log("myBids", myBids)
                    };
                };
            });
           console.log("myArr", myArr);
        var i;
        var c1 = 0
        var c2 = 1
        console.log("Below", myArr.length)
        for (i = -1; i < myArr.length; i++, i++) {
            function extend(obj, src) {
                Object.keys(src).forEach(function(key) {
                    obj[key] = src[key];
                });
                return obj;
            };
            //console.log("c1", c1);
            //console.log("c2", c2);
           if (myArr[c1] != null){
           var cBn = extend(myArr[c1], myArr[c2])};
            //myArr.splice(myArr[c2]);
            //console.log("cbn", cBn);
            myData.push(cBn);
            var c1 = c1 + 2;
            var c2 = c2 + 2;
        };
        myData.pop();
        //console.log("myData", myData);
        console.log(bidArr);





        // Scale the range of the data in the domains
        x.domain([0, d3.max(bidArr)
        ])
        y.domain(myData.map(function(d) {
            console.log("medsssss", d.medicine);
            return d.medicine;
        }));
        //y.domain([0, d3.max(data, function(d) { return d.sales; })]);

        // append the rectangles for the bar chart
        svg.selectAll(".bar")
            .data(myData)
            .enter().append("rect")
            .attr("class", "bar")
            //.attr("x", function(d) { return x(d.sales); })
            .attr("width", function(d) {
                //console.log("d", d.bid)
                return x(d.bid);
            })
            .attr("y", function(d) {
                //console.log("d", d.medicine)
                return y(d.medicine);
            })
            .attr("height", y.bandwidth())
            .on("mousemove", function(d){
            tooltip
              .style("left", d3.event.pageX - 50 + "px")
              .style("top", d3.event.pageY - 70 + "px")
              .style("display", "inline-block")
              .html( "Bid" + "<br>" + "$" + (d.bid));
        })
    		.on("mouseout", function(d){ tooltip.style("display", "none");});


        // add the x Axis
        svg.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(x));

        // add the y Axis
        svg.append("g")
            .call(d3.axisLeft(y));
 });            
    </script>
</body>

</html>